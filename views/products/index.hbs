<section class="container mt-5">
    <div class="row">

        <div class="col-md-10 m-auto">

            {{#if hasProducts}}
            <div >
            <form action="/" method="GET" class="form-inline text-center">
                <div class="form-group">
                    <input type="text" name="search" placeholder="Search Products" class="form-control">
                    <input type="submit" value="Search" class="btn btn-default">
                </div>
            </form>
            </div>
            {{#each products}}
            <div class="card card-body my-2 drop-shadow">
                <div
                    class="media align-items-center align-items-lg-start text-center text-lg-left flex-column flex-lg-row">
                    <a href="/products/{{_id}}">
                        <img src="/{{imageUrl}}" style="box-shadow:2px 2px 5px;" class="mr-4" width="160" height="160"
                            alt="{{title}}" style="object-fit: contain;">
                    </a>

                    <div class="media-body mr-3">
                        <h6 class="media-title font-weight-semibold">
                            <a href="/products/{{_id}}">{{title}}</a>
                        </h6>
                        <p class="mb-3" id="prodDesc"> {{desc}}</p>
                    </div>
                    <div class="mt-3 mt-lg-0 ml-lg-3 text-center">
                        <h3 class="">${{price}}</h3>

                        {{#if ../isAuthenticated}}
                        <form action="/cart" method="POST">
                            <button type="submit" class="btn btn-info mt-4 text-light">
                                <i class="fas fa-shopping-cart"></i> Add to Cart
                            </button>
                            <input type="hidden" name="id" value="{{_id}}">
                            <input type="hidden" name="path" value="/">
                        </form>

                        {{/if}}
                    </div>
                </div>
            </div>
            {{/each}}
        </div>
        {{else}}
        <h1>No Products</h1>
        {{/if}}
        <div>
            <form action='/add-product' method="GET" class="p-4 bg-dark card"
                style="box-shadow: 2px 2px 20px rgba(0,0,0,0.4);" enctype="multipart/form-data">
                <button type='submit' class="btn btn-primary">+ Add Product</button>
            </form>
        </div>
    </div>
</section>

<script>
    document.querySelectorAll('#prodDesc').forEach(para => {
        para.innerHTML = para.textContent;
    })
</script>